{% assign t = site.data.translations[page.lang] %}
<script>
  // Client-side router: extract chars from hash or path
  (function() {
    // First check for hash-based routing (e.g., /#三)
    var hash = window.location.hash.substring(1); // Remove #
    if (hash) {
      try {
        window.HANZI_PATH_CHARS = decodeURIComponent(hash);
        console.log('Extracted chars from hash:', hash);
        return;
      } catch (e) {
        console.error('Failed to decode hash:', e);
      }
    }
    
    // Fallback to path-based routing (e.g., /三)
    var path = window.location.pathname.replace(/^\/+|\/+$/g, '');
    // Strip language prefix if present
    if (path.startsWith('cn/')) {
      path = path.substring(3);
    } else if (path.startsWith('tw/')) {
      path = path.substring(3);
    }
    // Filter out language paths and special pages
    if (path && path !== '404.html' && path !== 'index.html' && path !== 'cn' && path !== 'tw' && !path.includes('.')) {
      // Store path for the demo script
      window.HANZI_PATH_CHARS = decodeURIComponent(path);
      console.log('Extracted chars from path:', path);
    }
  })();
</script>
<div class="demo container" id="practice">
  <h1>{{ t.title }}</h1>
  <p class="lead">
    {{ t.subtitle }}
  </p>
  
  <hr class="demo-divider" />

  <!-- <h4>{{ t.stroke_order_animation }}</h4>-->
  
  <form class="form-inline char-select-form js-char-form">
    <div class="form-group">
      <label for="character-select">
        {{ t.character_label }}
      </label>
      <input type="text" class="form-control character-select" id="character-select" placeholder="{{ t.character_placeholder }}" maxlength="6" value="你好" />
    </div>
    <div class="form-group script-selector">
      <label class="radio-label">
        <input type="radio" name="script-type" value="simplified" checked />
        <span>{{ t.script_simplified }}</span>
      </label>
      <label class="radio-label">
        <input type="radio" name="script-type" value="traditional" />
        <span>{{ t.script_traditional }}</span>
      </label>
    </div>
    <br>
    <small class="text-muted">{{ t.updates_automatically }}</small>
  </form>

  <p>{{ t.watch_description }}</p>
  <div class="demo-target" id="animation-target"></div>
  <div class="demo-controls">
    <form class="form-inline">
      <div class="checkbox">
        <label>
          <input type="checkbox" checked="checked" id="animation-show-outline" /> {{ t.show_outline }}
        </label>
      </div>
      <div class="checkbox">
        <label>
          <input type="checkbox" id="draw-mode" /> {{ t.draw_next_stroke }}
        </label>
      </div>
      <br>
      <div class="btn-group" role="group">
        <button class="btn btn-default" id="animate-reset"><i class="fas fa-undo"></i> {{ t.reset }}</button>
        <button class="btn btn-default" id="animate-prev"><i class="fas fa-chevron-left"></i> {{ t.prev }}</button>
        <button class="btn btn-primary" id="animate-play"><i class="fas fa-play"></i> {{ t.play }}</button>
        <button class="btn btn-default" id="animate-next">{{ t.next }} <i class="fas fa-chevron-right"></i></button>
      </div>
      <button class="btn btn-info" id="share-btn"><i class="fas fa-share-alt"></i> {{ t.share }}</button>
      <br><br>
      <div style="width: 80%; margin: 0 auto 10px auto; text-align: center;">
        <label for="speed-slider" class="text-muted" style="display:block;">
        {{ t.stroke_speed }}
        </label>
        <input type="range" id="speed-slider" min="0.25" max="2" step="0.25" value="1" style="width: 100%;">
        <small class="text-muted">
          <span id="speed-slider-label">1×</span>
        </small>
      </div>
      <div style="background-color: #f5f5f5; padding: 10px; border-radius: 5px; border: 1px solid #ddd; display: inline-block;">
        <div class="checkbox" style="margin-bottom: 5px;">
          <label style="font-size: 14px;">
            <input type="checkbox" checked="checked" id="show-mandarin" /> {{ t.show_mandarin }}
          </label>
        </div>
        <div class="checkbox" style="margin-bottom: 0;">
          <label style="font-size: 14px;">
            <input type="checkbox" id="show-cantonese" /> {{ t.show_cantonese }}
          </label>
        </div>
      </div>
      <br><br>
      <!-- Beginner Character Selection -->
      <div class="beginner-chars" style="margin: 0; background-color: #f8f9fa; border-radius: 6px; border: 1px solid #dee2e6; display: inline-block; max-width: 100%;">
        <div class="beginner-chars-header" style="padding: 10px 15px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; gap: 20px;" id="beginner-chars-toggle">
          <h6 style="margin: 0; color: #6c757d; white-space: nowrap; font-size: 14px; font-weight: 500;">{{ t.beginner_chars_title }}</h6>
          <i class="fas fa-chevron-down" id="beginner-chars-icon" style="color: #999; transition: transform 0.3s; font-size: 12px;"></i>
        </div>
        <div class="beginner-chars-content" id="beginner-chars-content" style="display: none; padding: 10px 15px 15px 15px; min-width: 450px;">
        
        <div class="char-category" style="margin-bottom: 10px;">
          <h6 style="font-size: 12px; color: #999; margin-bottom: 5px; font-weight: 500;">{{ t.basic_numbers }}</h6>
          <div class="char-buttons">
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="一" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">一</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="二" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">二</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="三" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">三</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="四" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">四</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="五" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">五</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="六" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">六</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="七" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">七</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="八" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">八</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="九" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">九</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="十" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">十</button>
          </div>
        </div>

        <div class="char-category" style="margin-bottom: 10px;">
          <h6 style="font-size: 12px; color: #999; margin-bottom: 5px; font-weight: 500;">{{ t.common_greetings }}</h6>
          <div class="char-buttons">
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="你" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">你</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="好" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">好</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="我" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">我</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="他" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">他</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="她" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">她</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="谢" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">谢</button>
          </div>
        </div>

        <div class="char-category" style="margin-bottom: 10px;">
          <h6 style="font-size: 12px; color: #999; margin-bottom: 5px; font-weight: 500;">{{ t.simple_chars }}</h6>
          <div class="char-buttons">
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="人" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">人</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="口" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">口</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="日" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">日</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="月" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">月</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="水" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">水</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="火" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">火</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="木" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">木</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="山" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">山</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="田" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">田</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="大" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">大</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="小" style="margin: 2px; min-width: 38px; padding: 3px 8px; font-size: 13px;">小</button>
          </div>
        </div>

        <div class="char-category">
          <h6 style="font-size: 12px; color: #999; margin-bottom: 5px; font-weight: 500;">{{ t.common_words }}</h6>
          <div class="char-buttons">
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="你好" style="margin: 2px; padding: 3px 8px; font-size: 13px;">你好</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="谢谢" style="margin: 2px; padding: 3px 8px; font-size: 13px;">谢谢</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="早上好" style="margin: 2px; padding: 3px 8px; font-size: 13px;">早上好</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="晚安" style="margin: 2px; padding: 3px 8px; font-size: 13px;">晚安</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="爸爸" style="margin: 2px; padding: 3px 8px; font-size: 13px;">爸爸</button>
            <button class="btn btn-sm btn-outline-secondary char-btn" data-char="妈妈" style="margin: 2px; padding: 3px 8px; font-size: 13px;">妈妈</button>
          </div>
        </div>
        </div>
      </div>
    </form>
  </div>
</div>

<!-- Marketing messaging and featurettes
================================================== -->
<!-- Wrap the rest of the page in another container to center all the content. -->

<div class="container marketing">
  <hr class="featurette-divider marketing-top-divider" />
  <div class="sub-features">
    <div class="sub-feature">
      <h4>{{ t.features.characters_count }}</h4>
      <p>
        {{ t.features.characters_desc }}
      </p>
    </div>
    <div class="sub-feature middle-subfeature">
      <h4>{{ t.features.proper_stroke_order }}</h4>
      <p>
        {{ t.features.proper_stroke_desc }}
      </p>
    </div>
    <div class="sub-feature">
      <h4>{{ t.features.free_accessible }}</h4>
      <p>
        {{ t.features.free_accessible_desc }}
      </p>
    </div>
  </div>
  <hr class="featurette-divider marketing-bottom-divider" />

  <h2>{{ t.about }}</h2>

  <p>{{ t.about_text }}</p>

  <p>{{ t.data_source }}</p>

  <h3>{{ t.why_learn_title }}</h3>
  <p>{{ t.why_learn_text }}</p>

  <h3>{{ t.how_it_works_title }}</h3>
  <p>{{ t.how_it_works_text }}</p>

  <h3>{{ t.duolingo_companion }}</h3>
  <p>{{ t.duolingo_companion_text }}</p>

</div><!-- /.container -->
